series: &series noble

machines:
  "0":
  "1":
  "2":
  "3":
    constraints: cores=2 mem=6G root-disk=25G virt-type=virtual-machine
  "4":
    constraints: cores=2 mem=6G root-disk=25G virt-type=virtual-machine
  "5":
    constraints: cores=2 mem=6G root-disk=25G virt-type=virtual-machine
  "6":
    constraints: cores=2 mem=6G root-disk=25G virt-type=virtual-machine
  "7":
    constraints: cores=2 mem=6G root-disk=40G virt-type=virtual-machine

applications:
  ceph-mon:
    charm: ch:ceph-mon
    channel: squid/stable
    num_units: 3
    base: ubuntu@24.04
    options:
      monitor-count: 3
    to:
      - "0"
      - "1"
      - "2"

  ceph-osd:
    charm: ch:ceph-osd
    num_units: 3
    channel: squid/stable
    base: ubuntu@24.04
    storage:
      osd-devices: "loop,5G"
    to:
      - "3"
      - "4"
      - "5"

  primary:
    charm: /home/ubuntu/artifacts/microceph.charm
    num_units: 1
    base: ubuntu@24.04
    options:
      wait-to-adopt: True
      # TODO: drop this once the change is available in the snap stable
      snap-channel: latest/edge/test
    to:
      - "6"

  secondary:
    charm: /home/ubuntu/artifacts/microceph.charm
    num_units: 1
    base: ubuntu@24.04
    storage:
      osd-standalone: "loop,5G,3"
    to:
      - "7"

relations:
  - - "ceph-osd:mon"
    - "ceph-mon:osd"
